---
title: "Final Project"
author: "Alicia Helfrich, Olivia Gomez, and Akbar Naqvi"
format: html
editor: visual
embed-resources: true
---

Outline from meeting:

-   Lit review

-   Overview of data sources

-   Exploratory Data Analysis and Data Cleaning

-   Building Models

-   Analyzing results - variable importance

-   Conclusion Limitations

-   download file for data folder: (Data and Documents - Primary Data File) link: https://www.census.gov/programs-surveys/sipp/data/datasets/2019-data/2019.html 
Download the Pipe-Delimited Text Format version to read in a CSV

## Project Overview

### Introduction

The Medicaid program, created in 1965, is a joint federal-state health insurance program. It provides coverage for health and other related services for the most economically disadvantaged populations, including low-income children and their families, low-income seniors, and low-income people with disabilities. It is a means-tested entitlement program, meaning individuals must earn less than a specified amount per year in order to qualify. However, eligibility criteria can vary by population group and state.

Given its definition as a federal-state venture to provide health coverage, states can establish their own eligibility guidelines, benefit packages, provider payment policies, and administrative structures. However, states must meet certain federal requirements in order to receive federal reimbursement for a share of program costs. States may choose to cover more population groups, but to receive federal funding, they must cover mandatory groups like low-income families with children. (https://www.macpac.gov/medicaid-101/eligibility/)

Coverage disruptions and losses in the Medicaid program can be defined as "churn." Changing financial circumstances and difficultly with the arduous renewal and redetermination processes are just two examples of why a beneficiary may lose Medicaid coverage. Research has shown that churn is associated with uninsurance and delayed care for beneficiaries. It also leads to higher administrative costs, less predictable state expenditures, and increased health care costs. (https://aspe.hhs.gov/sites/default/files/private/pdf/265366/medicaid-churning-ib.pdf)

During the COVID-19 pandemic, the federal government authorized a continuous enrollment provision for Medicaid. In order to receive an enhanced federal match rate and thus more federal dollars to operate the program, states had to maintain enrollment of nearly all beneficiaries during the Public Health Emergency (PHE). This provision ended in March of 2023, meaning that states were able to resume eligibility and redetermination checks after 3 years. This is expected to lead to the resumption of churn in the program, and thus increased administrative costs for states. (https://www.kff.org/medicaid/issue-brief/10-things-to-know-about-the-unwinding-of-the-medicaid-continuous-enrollment-provision/#three)

### Methodology

Using supervised machine learning techniques and the Survey of Income and Participation Data, we developed a model to predict the likelihood that a Medicaid beneficiary will churn out of the program during the course of a year; in other words, if they lose eligibility and are terminated from the program. While the main eligibility guideline for Medicaid is income, we believe that utilizing other demographic factors can be a helpful predictor of churn. Such a predictive model can help states reduce churn by targeting outreach and enrollment activities of states. For example, it may be in a state's best interest to target enrollment campaigns for other public insurance programs towards population groups of interest. This can ensure everyone who is eligible has access to the program, and can enroll people into other public programs (like a Marketplace plan) if they are eligible. Reducing the uninsured population can reduce health care costs for states. 

As mentioned before, states have different eligibility rules and guidelines. For example, three states allow for 12-month continuous eligibility, while others conduct periodic eligibility checks before the standard annual renewal date. To account for some of these variations, we have created several indicator variables. 

Sources of state eligibility variables:
-   (KFF tables - https://www.kff.org/report-section/medicaid-and-chip-eligibility-enrollment-and-cost-sharing-policies-as-of-january-2020-findings-from-a-50-state-survey-tables/)
-   (Commonwealth - https://www.commonwealthfund.org/publications/issue-briefs/2023/sep/ensuring-continuous-eligibility-medicaid-impacts-adults)



## Data Sources

The Survey of Income and Program Participation (SIPP) is an extensive survey conducted by the U.S. Census Bureau. It contains data on income, labor force participation, social program participation and eligibility,
and general demographic characteristics. We are using the SIPP given its breadth, detail, and inclusion of health insurance status. We are using data from the year 2019, which was the last full year before the start of the COVID-19 pandemic and three full years of continuous eligibility in Medicaid. Using data after 2019 would not allow us to accurately examine churn. It is important to note that survey parti

Survey participants provide data for each month in the preceding calendar year at the time of the interview. Because of this detail, observations are on the person-month level, meaning there could be 12 observations for a single person for a given variable. Household-level questions are copied across all members of the household.

```{r}

library(tidyverse)
library(haven)
library(data.table)
library(readxl)

```

### Reading in Data

```{r}

data_2019 <- fread("data/pu2019.csv", 
                   sep = "|",
                   showProgress = TRUE)


data_2019 <- data_2019 %>%
    select(-starts_with("A")) # these are status flags of all variables


data_2019_jan <- data_2019 %>%
  select(-starts_with("A")) %>%
  filter(MONTHCODE == 1) %>%
  # only include the month of January
  filter(RPUBTYPE2 == 1)
  # filter out people without Medicaid in the month of January 

# tibble of indicator variables for state eligibility rules of interest
state_eligibility_rules <- read_excel("state_eligibility_rules.xlsx")


# tibble of variables where every single value is missing (we can drop these)
missing_vars <- data_2019 %>%
  summarise_all(~all(is.na(.))) %>%
  gather(variable, is_missing) %>%
  filter(is_missing)


```

## Exploratory Data Analysis

### missingness (Akbar)

### correlation (Alicia)

### explore categorical variables of interest (Alicia - depending on Aaron's response)

### explore the distribution of outcome variable

### how do we decide what variables to drop?

## Predictive Modeling

-   precision versus accuracy - justify error metric
-   see if any variables are 100% missing once we drop to Medicaid and January
-   look out for allocation flags (if it was imputed), status flags all start with A
-   consider dropping and picking key variables in each issue area
-   seam mismatch

## Analyzing Results

## Conclusions and Limitations
